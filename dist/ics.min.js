/*! ics.js Fri Sep 17 2021 09:52:47 */

var ics=function(e,r){const c="\n",n=["SU","MO","TU","WE","TH","FR","SA"],a=["YEARLY","MONTHLY","WEEKLY","DAILY"];this.uidDomain=e??"default",this.prodId=r??"Calendar",this.calendarEvents=[],this.calendarStart=["BEGIN:VCALENDAR",`PRODID:${this.prodId}`,"VERSION:2.0"].join(c),this.calendarEnd="END:VCALENDAR",this.events=function(){return this.calendarEvents},this.calendar=function(){return this.calendarStart+c+this.calendarEvents.join(c)+c+this.calendarEnd},this.addAllDayEvent=function(e,r,t,n,a,i){return this.addEvent(e,r,t,!0,n,n,a,i)},this.addEvent=function(e,r,t,n,a,i,s,o){if(!(e&&r&&t&&a&&i))return!1;var u=n?"YYYYMMDD":"YYYYMMDDTHHmmss",n=n?"DATE":"DATE-TIME",a=moment(a).format(u),i=moment(i).format(u),u=moment().format("YYYYMMDDTHHmmss"),l=["BEGIN:VEVENT",`UID:${this.calendarEvents.length}@${this.uidDomain}`,"CLASS:PUBLIC",`DESCRIPTION:${r}`,`DTSTAMP;VALUE=DATE-TIME:${u}`,`DTSTART;VALUE=${n}:${a}`,`DTEND;VALUE=${n}:${i}`,`LOCATION:${t}`,`SUMMARY;LANGUAGE=en-us:${e}`,"TRANSP:TRANSPARENT"];if(s&&(s=this._validate_repeat_rules(s),l.splice(4,0,this._compose_repeat_rules(s))),o)for(const d in o)o.hasOwnProperty(d)&&l.push(`${d.toUpperCase()}:${o[d]}`);return l.push("END:VEVENT"),this.calendarEvents.push(l.join(c)),l},this.download=function(e,r){var t=this.build();if(!t)return null;r=r??"ics",e=e??"calendar";var n=new Blob([t],{type:"text/x-vCalendar;charset=UFT-8"});let a=document.createElement("a");return a.href=window.URL.createObjectURL(n),a.setAttribute("download",`${e}.${r}`),a.click(),t},this.build=function(){return 0===this.calendarEvents.length?null:this.calendar()},this._validate_repeat_rules=function(t){if(-1===a.indexOf(t.rrule))throw new Error("Recurrence rrule frequency must be provided and be one of the following: "+a.join(", "));if(t.until&&isNaN(Date.parse(t.until)))throw new Error("Recurrence rrule 'until' must be a valid date string");if(t.interval&&isNaN(parseInt(t.interval)))throw new Error("Recurrence rrule 'interval' must be an integer");if(t.count&&isNaN(parseInt(t.count)))throw new Error("Recurrence rrule 'count' must be an integer");if(t.byday){if(!Array.isArray(t.byday))throw new Error("Recurrence rrule 'byday' must be an array");if(7<t.byday.length)throw new Error("Recurrence rrule 'byday' array must not be longer than the 7 days in a week");t.byday=t.byday.filter((e,r)=>t.byday.indexOf(e)==r);for(var e of t.byday)if(-1===n.indexOf(e))throw new Error("Recurrence rrule 'byday' values must include only the following: 'SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'")}return t},this._compose_repeat_rules=function(e){let r;return e.rrule||(r=`rrule:FREQ=${e.freq}`,e.until&&(r+=`;UNTIL=${moment(e.until).format("YYYYMMDD[000000Z]")}`),e.interval&&(r+=`;INTERVAL=${e.interval}`),e.count&&(r+=`;COUNT=${e.count}`),e.byday&&0<e.byday.length&&(r+=`;BYDAY=${e.byday.join(",")}`),r)}};